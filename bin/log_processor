#!/usr/bin/env ruby
# frozen_string_literal: true

boot_file_path = File.expand_path('../lib/boot.rb', __dir__)
require boot_file_path

LOGS_DIR = '/tmp/'
LOGGER = Logger.new($stdout)
ROOT = File.expand_path('../..', __FILE__)

def log_reader(file)
  puts "Processing #{file}"
  file_parser = QuakeLogFileParser.new
  File.foreach(File.join(ROOT, file)) do |line|
    file_parser.parse line
  end
  file_parser.print
  puts "Log #{file} processed correctly"
  #FileUtils.rm(file)
  puts "#{Time.now} -- Finished. Exiting now."
rescue StandardError => e
  LOGGER.error("#{e.class}: #{e.message}")
  LOGGER.error(e.backtrace)
  exit 1
end

def run
  log_reader('spec/fixture/qgames.log')
end

run
